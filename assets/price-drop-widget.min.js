var PriceDropWidget = (() => {
    var E = (s, t) => () => (t || s((t = { exports: {} }).exports, t), t.exports); var b = E(() => {
        document.addEventListener("DOMContentLoaded", () => {
            let s = "https://price-drop-notifier-server-codeques.vercel.app", t = document.getElementById("price-drop-widget-root"); t && (t.innerHTML = `
      <div class="form-container">
        <button id="price-drop-toggle-btn" class="toggle" aria-expanded="false">
            <span id="price-drop-toggle-text">Email me if this product gets cheaper</span>
        </button>

        <div id="price-drop-panel" class="panel">
            <form id="price-drop-form">
                <input type="email" name= "widget_email"placeholder="you@example.com" required />
                <button type="submit">Notify me</button>
                <p id="price-drop-error-msg" class="error" style="display: none;">Something went wrong</p>
                <p id="price-drop-success-msg" class="success" style="display: none;">You will be notified!</p>
                <p id="price-drop-loading" class="loading" style="display: none;"></p>
            </form>
        </div>
    </div>
    `); let i = document.getElementById("price-drop-toggle-btn"), a = document.getElementById("price-drop-toggle-text"), m = document.getElementById("price-drop-panel"), g = document.getElementById("price-drop-form"), o = document.getElementById("price-drop-error-msg"), c = document.getElementById("price-drop-success-msg"), l = document.getElementById("price-drop-loading"), u = { name: "Men\u2019s Lacoste Classic Fit Polo Long Sleeve Shirt Size L Regular Fit Dark Gray", price: "USD 36.0", url: "https://www.ebay.com/itm/397409678293?_trkparms=it\u2026Cclp%3A2332490&itmmeta=01KGSPK31KS1JG6TDQV9HS9H15" }, n = document.createElement("input"); n.type = "hidden", n.name = "userscript_product", n.value = JSON.stringify(u), document.getElementById("price-drop-form").appendChild(n), i.addEventListener("click", () => { let e = !(i.getAttribute("aria-expanded") === "true"); i.setAttribute("aria-expanded", e), a.textContent = e ? "Hide" : "Email me if this product gets cheaper", m.classList.toggle("open", e) }), g.addEventListener("submit", async d => { d.preventDefault(), o.style.display = "none", l.style.display = "block", c.style.display = "none"; let e = new FormData(d.target); console.log(e); let y = e.get("widget_email"), f = e.get("userscript_product"); console.log("product:", f), console.log("Email:", y); let p = Object.fromEntries(e.entries()); console.log(p); try { let r = await fetch(`${s}/subscribe-price-drop`, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(p) }); r.ok && (isSuccessful = !0, c.style.display = "block"), r.status == 409 && (o.style.display = "block", o.textContent = "You are already registered") } catch (r) { console.error(r), o.style.display = "block" } finally { l.style.display = "none" } })
        })
    }); return b();
})();
